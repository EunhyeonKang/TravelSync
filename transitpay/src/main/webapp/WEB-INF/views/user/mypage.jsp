<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" href="../../../resources/css/conacoount.css">
    <link rel="stylesheet" href="../../../resources/css/mypage.css">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script defer src="../../../resources/js/mypage.js"></script>
</head>
<body>
<div class="main">
    <%@ include file="../include/header.jsp" %>
    <div class="backgroundbox">
        <div class="topbox">
            <div class="contents">
                <div class="contents-1">
                    <div class="accountbox">
                        <div class="mypage-user">
                            <div class="user-detail">
                                <div class="mypage-box">
                                    <c:choose>
                                        <c:when test="${sessionScope.member.kakao_id == 0}">
                                            <img style="width: 50px; margin: 20px;border-radius: 50%" src="../../resources/upload/profile/${sessionScope.member.kakao_img}">
                                        </c:when>
                                        <c:otherwise>
                                            <img style="width: 50px;margin: 20px;border-radius: 50%" src="${sessionScope.member.kakao_img}">
                                        </c:otherwise>
                                    </c:choose>
                                    <p><strong>${sessionScope.member.name}</strong>Îãò ÌôòÏòÅÌï©ÎãàÎã§</p>
                                </div>
                                <div id="myTextarea">${sessionScope.member.code}</div>
                                <button id="myButton">Î≥µÏÇ¨</button>
                                <script>
                                    const myTextarea = document.getElementById("myTextarea");
                                    document.getElementById("myButton").onclick = () => {
                                        window.navigator.clipboard.writeText(myTextarea.value).then(() => {
                                            alert("Î≥µÏÇ¨ÏôÑÎ£å");
                                        });
                                    };
                                </script>
                                <div class="mypage_logout">Î°úÍ∑∏ÏïÑÏõÉ</div>
                            </div>
                            <div class="menu1">
                                <div class="menu1-1">ÎßàÏù¥ÌéòÏù¥ÏßÄ</div>
                                <div class="menuhr"><hr/></div>
                                <a href="group">ÎÇ¥Ï†ïÎ≥¥ÏàòÏ†ï</a>
                                <div class="menu1-1">Ïó¨ÌñâÍ¥ÄÎ¶¨</div>
                                <div class="menuhr"><hr/></div>
                                <a href="/saveTravel">Ï†ÄÏû•ÎêúÏó¨Ìñâ</a>
                                <a href="/afterTravel">Î™®Ïó¨ÎùºÏó¨Ìñâ</a>
                                <div class="menu1-1">Î™®ÏûÑ/Í≥ÑÏ¢å Í¥ÄÎ¶¨</div>
                                <div class="menuhr"><hr/></div>
                                <a href="group">Î™®ÏûÑÎÇ¥Ïó≠</a>
                                <a href="group">Í≥ÑÏ¢åÎÇ¥Ïó≠</a>
                            </div>
                        </div>
                    </div>
                    <div class="accountbox">
                        <h2>Ïó¨Ìñâ Í¥ÄÎ¶¨</h2>
                        <div class="travelbox">
                            <div class="travelbox-1">
                                <div>
                                    <div>
                                        <div class="travelsavebox">
                                            <img class="saveImg" src="../../../resources/images/save-time.svg" style="width: 70px;">
                                            <div>Ï†ÄÏû•Îêú Ïó¨Ìñâ</div>
                                            <div class="saveboxcnt"><strong><a href="/saveTravel" id="travleLength"></a></strong></div>
                                        </div>
                                    </div>
                                    <button>Ïó¨Ìñâ | Ï∞úü©∑</button>
                                </div>
                            </div>
                            <div class="travelbox-2">
                                <div>
                                    <div>
                                        <div class="travelsavebox">
                                            <img class="saveImg" src="../../../resources/images/save-hassle.svg" style="width: 70px;">
                                            <div>Ïó¨ÌñâÌöåÎπÑ</div>
                                            <div class="saveboxcnt"><strong><a href="/afterTravel" id="completeTravelLength"></a></strong></div>
                                        </div>
                                    </div>
                                    <button>Î™®Ïó¨ÎùºÌöåÎπÑüí∞</button>
                                </div>
                            </div>
                            <div class="travelbox-3">
                                <div class="chartbox">
                                    <canvas id="myChart"></canvas>
                                </div>
                                </p>
                                <div>
                                    <button>ÎÇ¥ Ïó¨Ìñâ Î¶¨Ìè¨Ìä∏üìà</button>
                                </div>
                            </div>
                            <p id="travelreport">
                        </div>
                        <h2>Í≥ÑÏ¢å Í¥ÄÎ¶¨</h2>
                        <div class="account-box-1">
                            <div class="account-details">
                                <a href="/accountDetail">
                                    <button class="account-button">Ïó∞Í≤∞Í≥ÑÏ¢å</button>
                                </a>
                                <div class="bank"></div>
                                <div class="account-info">
                                    <span class="account-number" name="account_num"></span>
                                    <input type="hidden" name="accountId" value="">
                                    <button class="change-account" id="change-account">Ïó∞Í≤∞Í≥ÑÏ¢å Î≥ÄÍ≤Ω</button>
                                </div>
                            </div>
                            <div class="account-box">
                                <div class="account-box-2">
                                    <img src="../../resources/images/new_2204_my_login_ico001.png" alt="">
                                    <button class="account-month" id="custom-account-month">Ïù¥Î≤àÎã¨ Ïù¥Ïö©ÎÇ¥Ïó≠ > </button>
                                    <div class="account-cnt">
                                        <div class="cnt-1-1" id="month-cnt"></div><span class="cnt-1">Í±¥</span>
                                        <div class="cnt-1-1" id="month-balance"></div><span class="cnt-1">Ïõê</span>
                                    </div>
                                </div>
                                <div class="account-box-2">
                                    <img src="../../resources/images/new_2204_my_login_ico004.png" alt="">
                                    <button onclick="openModal()" class="account-month" id="non-payment-account">ÎØ∏ÎÇ© ÌöåÎπÑ ÌòÑÌô© > </button>
                                    <div class="account-cnt">
                                        <div class="cnt-1-2" id="payment-cnt"></div><span class="cnt-1">Í±¥</span>
                                        <div class="cnt-1-2" id="payment-balance"></div><span class="cnt-1">Ïõê</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <h2>Î™®ÏûÑ Í¥ÄÎ¶¨</h2>
                        <div class="card-1">
                            <div class="account2">
                                <div class="auto-charge-box">
                                    <div class="new-account-details">
                                        <div class="slider-2">
                                            <div class="side-btns">
                                                <div><span><i class="fas fa-caret-left"></i></span></div>
                                                <div><span><i class="fas fa-caret-right"></i></span></div>
                                            </div>
                                            <div class="slides">
                                                <div class="slide2-1 active">
<%--                                                <button class="account-button" onclick="location.href='/mygroup/${groupAccount.group_id}'">Î™®ÏûÑÌÜµÏû•</button>--%>
<%--                                                <div class="bank">${groupAccount.group_name}</div>--%>
<%--                                                <div class="account-info">--%>
<%--                                                    <span class="account-number">${groupAccount.group_account}</span>--%>
<%--                                                    <input type="hidden" name="accountId" value="">--%>
<%--                                                    <button class="change-account" onclick="location.href='/groupAccountDetail'">Î™®ÏûÑÌÜµÏû• ÎÇ¥Ïó≠</button>--%>
<%--                                                </div>--%>
                                                </div>
                                                <div class="slide2-1"></div>
                                                <div class="slide2-1"></div>
                                            </div>

                                            <div class="page-nav">
                                                <div class="active"></div>
                                                <div></div>
                                                <div></div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                                <div class="auto-charge-box-2">
                                    <div class="auto-charge-box-1">
                                        <div class="auto-charge">
                                            <span class="charge-info">ÏûêÎèôÏù¥Ï≤¥</span>
                                        </div>
                                        <div class="auto-charge2">
                                            <div class="chargebtn">
                                                <button class="charge-save-button" id="enroll">Ïã†Ï≤≠</button>
                                            </div>
                                            <div class="chargebtn">
                                                <button class="charge-save-button" id="cancel">Ìï¥ÏßÄ</button>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="auto-charge-box-1">
                                        <div class="auto-charge">
                                            <span class="charge-info">Î™®ÏûÑÏàòÏ†ï Î∞è ÌÉàÌá¥</span>
                                        </div>
                                        <div class="auto-charge2">
                                            <div class="chargebtn">
                                                    <button class="charge-save-button" id="updateGroup">ÏàòÏ†ï</button>
                                            </div>
                                            <div class="chargebtn">
                                                <button class="charge-save-button" id="deleteGroup">ÌÉàÌá¥</button>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="notificationbox">
                                <div class="notification">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal" id="myModal1" >
        <div id="pincode">
            <div class="table">
                <div class="cell">
                    <div id="anleitung">
<%--                        <div class="close" onclick="closeModal()">x</div>--%>
                        <p>
                            <strong>Î™®ÏûÑ ÎπÑÎ∞ÄÎ≤àÌò∏ ÏûÖÎ†•</strong><br> ÎπÑÎ∞ÄÎ≤àÌò∏ 4ÏûêÎ¶¨Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî
                        </p>
                    </div>

                    <div id="fields">
                        <div class="grid">
                            <div class="grid__col grid__col--1-of-4 numberfield"><span></span></div>
                            <div class="grid__col grid__col--1-of-4 numberfield"><span></span></div>
                            <div class="grid__col grid__col--1-of-4 numberfield"><span></span></div>
                            <div class="grid__col grid__col--1-of-4 numberfield"><span></span></div>
                        </div>
                    </div>

                    <div id="numbers">
                        <div class="grid">
                            <div class="grid__col grid__col--1-of-3"><button>1</button></div>
                            <div class="grid__col grid__col--1-of-3"><button>2</button></div>
                            <div class="grid__col grid__col--1-of-3"><button>3</button></div>

                            <div class="grid__col grid__col--1-of-3"><button>4</button></div>
                            <div class="grid__col grid__col--1-of-3"><button>5</button></div>
                            <div class="grid__col grid__col--1-of-3"><button>6</button></div>

                            <div class="grid__col grid__col--1-of-3"><button>7</button></div>
                            <div class="grid__col grid__col--1-of-3"><button>8</button></div>
                            <div class="grid__col grid__col--1-of-3"><button>9</button></div>

                            <div class="grid__col grid__col--1-of-3"></div>
                            <div class="grid__col grid__col--1-of-3"><button>0</button></div>
                            <div class="grid__col grid__col--1-of-3"></div>

                        </div>
                    </div>

                </div>
            </div>
        </div>
        <div id="restartbtn">RESTART</div>
    </div>
</div>
    <div id="customModal" class="custom-modal">
        <div class="custom-modal-content">
            <span class="custom-close">&times;</span>
            <h2 class="monthstate">Ïù¥Î≤àÎã¨ Ïù¥Ïö©ÎÇ¥Ïó≠</h2>
        </div>
    </div>
    <div id="unpaidModal" class="modal">
        <div class="unpaid-modal-content">
            <span class="unpaid-close-btn" onclick="closeModal()">&times;</span>
            <h2 class="monthstate">ÎØ∏ÎÇ© ÌöåÎπÑ ÏïàÎÇ¥</h2>
            <p>ÎØ∏ÎÇ©Îêú ÌöåÎπÑ Ï†ïÎ≥¥Î•º Ïó¨Í∏∞Ïóê ÌëúÏãúÌï©ÎãàÎã§.</p>
        </div>
    </div>
    <div id="updateModal" class="update-modal">
        <div class="update-modal-content">
            <span class="update-close">&times;</span>
            <h2>Î™®ÏûÑÏàòÏ†ï</h2>
            <table>
                <tr>
                    <td>Í∑∏Î£π Ïù¥Î¶Ñ:</td>
                    <td id="groupName"></td>
                </tr>
                <tr>
                    <td>Í∑∏Î£π Í≥ÑÏ¢å:</td>
                    <td id="groupAccount"></td>
                </tr>
                <tr>
                    <td>Í∑∏Î£π ÏûîÏï°:</td>
                    <td id="groupBalance"></td>
                </tr>
                <tr>
                    <td>(Îß§Îã¨)Ïõî ÎÇ©Î∂ÄÏùº:</td>
                    <td><input type="text" id="groupDay"></td>
                </tr>
                <tr>
                    <td>Ïõî ÌöåÎπÑ:</td>
                    <td><input type="text" id="groupDues"></td>
                </tr>
                <tr>
                    <td>ÏûêÎèô ÎÇ©Î∂Ä:</td>
                    <td>
                        <select name="g_autopay" class="rec6" id="groupAutopay">
                            <option value="" selected>ÏÑ†ÌÉù</option>
                            <option value="N">N</option>
                            <option value="Y">Y</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>ÎπÑÎ∞ÄÎ≤àÌò∏:</td>
                    <td><input type="password" id="groupPassword"></td>
                </tr>
            </table>
            <button id="updateButton">Ï†ÄÏû•</button>
        </div>
    </div>
    <div id="accountModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="account-container">
                <div class="account-hana">
                    <h3>Ìä∏ÎûòÎ∏îÏã±ÌÅ¨</h3>
                    <h2>Ïó∞Í≤∞Í≥ÑÏ¢å Ï†ïÎ≥¥ÏòàÏöî</h2>
                    <p>Ï£ºÍ≥ÑÏ¢åÎ•º Î≥ÄÍ≤ΩÌï† Ïàò ÏûàÏäµÎãàÎã§.</p>
                    <div>
                        <div id="searchForm" action="/controller/board/list" method="get">
                            <select name="type" class="selecttype" id="selecttype">
                            </select>
                            <input type="text" name="accountNum" value="">
                            <input type="hidden" name="amount" value="">
                            <button type="button" class="account-change-btn" id ="auth-res-button">Ïó∞Í≤∞Í≥ÑÏ¢å Î≥ÄÍ≤Ω</button>
                        </div>
                    </div>
                    <div class="account-total">
                        <div class="openbanking">
                            ÌïòÎÇòÏπ¥Îìú Ïò§ÌîàÎ±ÖÌÇπ
                        </div>
                        <button class="selectbtn">
                            Í≥ÑÏ¢åÌïúÎ≤àÏóê Ï°∞ÌöåÌïòÍ∏∞
                        </button>
                    </div>
                    <div class="acc-box">
                        <div class="add-acc-box">
                            <h3>ÌïòÎÇòÌä∏Î†åÏßÄÌéòÏù¥</h3>
                            <h2>Í≥ÑÏ¢åÍ∞Ä ÏóÜÏúºÏã†Í∞ÄÏöî?</h2>
                            <a href="">Í≥ÑÏ¢åÍ∞úÏÑ§ÌïòÍ∏∞</a>
                            <img src="../../../resources/images/account.png">
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="deletemodal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeModal">√ó</span>
            <h3>ÏÇ≠Ï†ú ÌôïÏù∏</h3>

            <p>Ï†ïÎßêÎ°ú ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?</p>
            <img src="../../../resources/images/check.webp" style="width: 70px;margin: 5px;">
            <table id="groupTable" class="group-table">
                <thead>
                <tr>
                    <th>ÏÑ†ÌÉù</th>
                    <th>Í∑∏Î£π Ïù¥Î¶Ñ</th>
                    <th>Í≥ÑÏ¢å</th>
                    <th>ÏûîÏï°</th>
                    <th>ÏûêÎèôÍ≤∞Ï†ú</th>
                </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
            <br>
            <hr>
            <div style="color: #ee002d">Î™®ÏûÑÌÉàÌá¥Îäî Î™®ÏûÑÏû•Îßå Ìï† Ïàò ÏûàÏäµÎãàÎã§. Î™®ÏûÑÏõêÏùº Í≤ΩÏö∞ Î™®ÏûÑÌá¥Ïû•ÌïòÍ≤å Îê©ÎãàÎã§.</div>
            <div style="color: #ee002d">Î™®ÏûÑÏùÑ ÌÉàÌá¥Ìï† Ïãú Î™®ÏûÑ Í≥ÑÏÑ§ Ïãú Ïó∞Í≤∞Îêú Í≥ÑÏ¢åÏóê ÌôòÍ∏âÎê©ÎãàÎã§.</div>
            <button id="confirmDelete" class="delete-button">ÏÇ≠Ï†ú</button>
        </div>
    </div>

    <div id="cardModal" class="modal1">
        <div class="modal-content1 card-modal-content">
            <span class="close1" onclick="closeCardModal()">&times;</span>
            <h2 class="card-title">Î™®Ïó¨Îùº Ï≤¥ÌÅ¨Ïπ¥Îìú(1394)</h2>
            <div class="date-search">
                <label for="selectedMonth">ÎÇ†Ïßú ÏÑ†ÌÉù:</label>
                <select id="selectedMonth">
                    <option value="2023-01">2023ÎÖÑ 1Ïõî</option>
                    <option value="2023-02">2023ÎÖÑ 2Ïõî</option>
                </select>
                <button class="date-search" onclick="searchByMonth()">Í≤ÄÏÉâ</button>
            </div>
            <div class="card-details">
                <div class="card-label">10Ïõî ÏÇ¨Ïö©Í∏àÏï°</div>
                <div class="card-usage">
                    <div class="card-box">
                        <div class="card-value">415,000Ïõê</div>
                    </div>
                    <div class="card-buttons">
                        <button class="card-button">Ïù¥Î≤àÎã¨ Ïπ¥ÎìúÏã§Ï†Å</button>
                        <button class="card-button card-cashback-button">
                            <span>Î∞õÏùÄ Ï∫êÏãúÎ∞±</span>
                            <span class="one">0Ïõê</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="card-history">
                <table id="cardHistoryTable" class="display" style="width:100%">
                    <thead>
                    <tr>
                        <th>Í±∞ÎûòÏùºÏûê</th>
                        <th>Í±∞ÎûòÎÇ¥Ïö©</th>
                        <th>Í±∞ÎûòÍ∏àÏï°</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>2023-11-04</td>
                        <td>ÎèÑÌÜ∞Ïπ¥Ï∏† Ï≤≠ÎùºÏ†ê</td>
                        <td>-253,000Ïõê</td>
                    </tr>
                    <tr>
                        <td>2023-11-04</td>
                        <td>Î≤†Ïä§Ìä∏Ïõ®Ïä§ÌÑ¥ ÌïòÎ≤ÑÌååÌÅ¨Ìò∏ÌÖî</td>
                        <td>-32,000Ïõê</td>
                    </tr>Ïπ¥
                    <tr>
                        <td>2023-11-05</td>
                        <td>ÌååÎùºÎã§Ïù¥Ïä§ Ïî®Ìã∞ Ïî®Î©îÎ•¥(Ïù∏Ï≤ú)</td>
                        <td>-60,000Ïõê</td>
                    </tr>
                    <tr>
                        <td>2023-11-05</td>
                        <td>ÏÜêÏª§ÌîºÏó∞Íµ¨ÏÜå ÏòÅÏ¢ÖÌïòÎäòÎèÑÏãúÏ†ê</td>
                        <td>-10,000Ïõê</td>
                    </tr>
                    <tr>
                        <td>2023-11-05</td>
                        <td>ÌÉïÌõÑÎ£®</td>
                        <td>-12,000Ïõê</td>
                    </tr>
                    <tr>
                        <td>2023-11-06</td>
                        <td>Ï≤≠ÎùºÏôïÏïÑÍµ¨</td>
                        <td>-28,000Ïõê</td>
                    </tr>
                    <tr>
                        <td>2023-11-06</td>
                        <td>ÌïòÎÇòÎ°úÎßàÌä∏</td>
                        <td>-20,000Ïõê</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
<%--    <%@ include file="../include/footer.jsp" %>--%>
</div>
</body>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css">
<script type="text/javascript" src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.23/css/jquery.dataTables.min.css"/>
<script>
    function phoneModal(){
        var deletemodal = document.querySelector('#deletemodal');
        deletemodal.style.display='none';
        var modal = document.getElementById('myModal1');
        modal.style.display = 'block';
        jQuery(document).ready(function($) {
            $(document).ready(function() {

                var pin = (+!![] + []) + (!+[] + !![] + []) + (!+[] + !![] + !![] + []) + (!+[] + !![] + !![] + !![] + []);
                var enterCode = "";
                enterCode.toString();

                $("#numbers button").click(function() {

                    var clickedNumber = $(this).text().toString();
                    enterCode = enterCode + clickedNumber;
                    var lengthCode = parseInt(enterCode.length);
                    lengthCode--;
                    $("#fields .numberfield:eq(" + lengthCode + ")").addClass("active");

                    if (lengthCode == 3) {
                        var enteredCode = parseInt(enterCode);

                        var groupId = "${groupId}";
                        $.ajax({
                            type: "POST",
                            url: "/inputCheckPassword",
                            data: { groupId : groupId },
                            success: function(response) {
                                var storePw = parseInt(response.trim());
                                // Î™®Îã¨ Îã´Í∏∞
                                $('#deletemodal').hide();
                                $('#myModal1').hide();
                                var groupId = "${sessionScope.groupAccount.group_id}";
                                $.ajax({
                                    type: "POST",
                                    url: "/deleteGroups",
                                    data: { groupId: groupId },
                                    success: function(response) {
                                        alert("Í∑∏Î£πÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.")
                                        location.href = "/";
                                    },
                                    error: function(error) {
                                    }
                                });
                            },
                            error: function(error) {
                            }
                        });
                        if (enterCode == pin) {
                            $("#fields .numberfield").addClass("right");
                            $("#numbers").addClass("hide");
                            $("#anleitung p").html("Amazing!<br>You entered the correct Code!");

                        } else {
                            $("#fields").addClass("miss");
                            enterCode = "";
                            setTimeout(function() {
                                $("#fields .numberfield").removeClass("active");
                            }, 200);
                            setTimeout(function() {
                                $("#fields").removeClass("miss");
                            }, 500);

                        }

                    } else {}

                });

                $("#restartbtn").click(function(){
                    enterCode = "";
                    $("#fields .numberfield").removeClass("active");
                    $("#fields .numberfield").removeClass("right");
                    $("#numbers").removeClass("hide");
                    $("#anleitung p").html("<strong>Please enter the correct PIN-Code.</strong><br> It is: 1234 / Also try a wrong code");
                });

            });
        });
    }

    $("#enroll").click(function(){
        var groupId = "${sessionScope.groupAccountDetail.group_id}";
        $.ajax({
            type: "POST",
            url: "/selectGroupAutopay",
            data: { groupId : groupId},
            success: function (response) {
               if(response==="Y"){
                   alert("ÏûêÎèôÏù¥Ï≤¥ Ïã†Ï≤≠Ïù¥ ÎêòÏóàÏäµÎãàÎã§.")
               }else{

               }
            }
        });
    })
    $("#cancel").click(function(){
        var groupId = "${sessionScope.groupAccountDetail.group_id}";
        $.ajax({
            type: "POST",
            url: "/deleteGroupAutopay",
            data: { groupId : groupId},
            success: function (response) {
                alert(response)
            }
        });
    })




    $.ajax({
        type: "POST",
        url: "/selectGroupInfo",
        data: { groupId: "${sessionScope.groupAccountDetail.group_id}" },
        success: function (response) {
            var groupTable = document.getElementById("groupTable").getElementsByTagName('tbody')[0];
            response.forEach(function (item) {
                document.getElementById("groupAccount").textContent = item.group_account;
                document.getElementById("groupBalance").textContent = item.g_balance.toLocaleString() + "Ïõê";
                document.getElementById("groupDay").value = item.g_day; // input ÏöîÏÜåÏù¥ÎØÄÎ°ú .valueÎ•º ÏÇ¨Ïö©
                document.getElementById("groupDues").value = item.g_dues; // input ÏöîÏÜåÏù¥ÎØÄÎ°ú .valueÎ•º ÏÇ¨Ïö©
                document.getElementById("groupAutopay").value = item.g_autopay;
                document.getElementById("groupPassword").value = item.group_pw; // ÎπÑÎ∞ÄÎ≤àÌò∏ input ÏöîÏÜå
                var row = groupTable.insertRow(-1);

                var checkboxCell = row.insertCell(0);
                var checkbox = document.createElement("input");
                checkbox.type = "checkbox";
                checkbox.name = "groupToDelete";
                checkbox.value = item.group_id;
                checkboxCell.appendChild(checkbox);

                var dataCells = [
                    item.group_name,
                    item.group_account,
                    item.g_balance.toLocaleString() + "Ïõê",
                    item.g_autopay
                ];

                for (var i = 0; i < dataCells.length; i++) {
                    var cell = row.insertCell(i + 1);
                    cell.textContent = dataCells[i];
                }
            });

            document.getElementById("groupName").textContent = response[0].group_name;
            var selectedGroupIds = [];
            var checkboxes = document.getElementsByName("groupToDelete");


            for (var i = 0; i < checkboxes.length; i++) {
                checkboxes[i].addEventListener("change", function () {
                    if (this.checked) {
                        selectedGroupIds.push(this.value);
                    } else {
                        var index = selectedGroupIds.indexOf(this.value);
                        if (index !== -1) {
                            selectedGroupIds.splice(index, 1);
                        }
                    }
                });
            }

        }
    });


    if ("${sessionScope.member}" !== "") {
        var memberId = "${sessionScope.member.member_id}";
        $.ajax({
            type: "POST",
            url: "/JoinGroupAccountAndMemberAccount",
            success: function (response) {
                if (response.length > 0) {
                    for (let index = 0; index < response.length; index++) {
                        const groupId = response[index].group_id;
                        $.ajax({
                            type: "POST",
                            url: "/selectGroupAccountInfo",
                            data: { memberId: memberId, groupId: groupId },
                            success: function (groupResponse) {
                                var slide2 = document.querySelector('.slides .slide2-1:nth-child('+(index+1)+')');
                                var accountGroup = document.createElement('div');
                                accountGroup.className='account-group';
                                if (groupResponse !== null) {
                                    var groupAccountButton = document.createElement("button");
                                    groupAccountButton.classList.add("account-button");
                                    groupAccountButton.textContent = "Î™®ÏûÑÌÜµÏû•";
                                    groupAccountButton.onclick = function() {
                                        location.href = "/mygroup/" + groupResponse.group_id;
                                    };

                                    var cardButton = document.createElement("button");
                                    cardButton.classList.add("account-button");
                                    cardButton.addEventListener("click", function(){
                                        openCardModal();
                                    });
                                    cardButton.textContent = "Ïπ¥ÎìúÎÇ¥Ïó≠";


                                    var groupAccountBankDiv = document.createElement("div");
                                    groupAccountBankDiv.classList.add("bank");
                                    groupAccountBankDiv.textContent = groupResponse.group_name;

                                    var groupAccountInfoDiv = document.createElement("div");
                                    groupAccountInfoDiv.classList.add("account-info");

                                    var groupAccountInfoSpan = document.createElement("span");
                                    groupAccountInfoSpan.classList.add("account-number");
                                    groupAccountInfoSpan.textContent = groupResponse.group_account;

                                    var groupAccountInfoInput = document.createElement("input");
                                    groupAccountInfoInput.type = "hidden";
                                    groupAccountInfoInput.name = "accountId";
                                    groupAccountInfoInput.value = "";

                                    var groupAccountInfoButton = document.createElement("button");
                                    groupAccountInfoButton.classList.add("change-account");
                                    groupAccountInfoButton.textContent = "Î™®ÏûÑÌÜµÏû• ÎÇ¥Ïó≠";
                                    groupAccountInfoButton.onclick = function() {
                                        location.href = "/groupAccountDetail";
                                    };

                                    groupAccountInfoDiv.appendChild(groupAccountInfoSpan);
                                    groupAccountInfoDiv.appendChild(groupAccountInfoInput);
                                    groupAccountInfoDiv.appendChild(groupAccountInfoButton);

                                    accountGroup.appendChild(groupAccountButton);
                                    accountGroup.appendChild(cardButton);
                                    accountGroup.appendChild(groupAccountBankDiv);
                                    accountGroup.appendChild(groupAccountInfoDiv);
                                    slide2.appendChild(accountGroup)
                                } else {
                                }
                            },
                            error: function (error) {
                            }
                        });
                    }
                } else {

                }
            },
            error: function (error) {
            },
        });
    }

</script>
</html>
